(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 10.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     44396,       1217]
NotebookOptionsPosition[     42807,       1167]
NotebookOutlinePosition[     43141,       1182]
CellTagsIndexPosition[     43098,       1179]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"--", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"-", 
                RowBox[{"--", 
                 RowBox[{"--", "--"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}], " ", 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"--", " ", 
    RowBox[{"@", 
     RowBox[{"author", ":", " ", 
      RowBox[{"Maziar", " ", 
       RowBox[{"Raissi", " ", "--"}]}]}]}]}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"--", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", "-"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}], " ", 
   "*)"}]}]], "Input",
 CellChangeTimes->{{3.710252723818885*^9, 3.7102527310325603`*^9}, {
  3.712278282953082*^9, 3.712278327136301*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"<<", "ToMatlab.m"}], ";"}]], "Input",
 CellChangeTimes->{{3.667325186112423*^9, 3.667325192641292*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"--", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", "-"}]}]}]}]}]}]}]}]}]}]}]}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", " ", 
       RowBox[{
        RowBox[{
         RowBox[{"Directory", " ", "--"}], "--"}], "--"}]}]}]}], "-"}], " ", 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"--", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", "-"}]}]}]}]}]}]}]}]}]}]}]}], " ", 
   "*)"}]}]], "Input",
 CellChangeTimes->{{3.710252723818885*^9, 3.7102527310325603`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
  "Dir", " ", "=", " ", 
   "\"\</users/mraissi/Desktop/HiddenPhysicsModel/Kernels/Schrodinger\>\""}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.7102527474167843`*^9, 3.7102527516253977`*^9}, {
  3.710253067010138*^9, 3.710253068511323*^9}, {3.7102611744036016`*^9, 
  3.710261175288665*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"--", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"-", 
              RowBox[{"--", "-"}]}]}]}]}]}]}]}]}]}]}]}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", " ", 
       RowBox[{
        RowBox[{
         RowBox[{"Operator", " ", "--"}], "--"}], "--"}]}]}]}], "-"}], " ", 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"--", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", "--"}]}]}]}]}]}]}]}]}]}]}], " ", "*)"}]}]], "Input",\

 CellChangeTimes->{{3.7102527045531397`*^9, 3.710252715601753*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"L", "[", 
     RowBox[{"x_", ",", "ubar_", ",", "vbar_"}], "]"}], "=", " ", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"dt", 
       RowBox[{"(", " ", 
        RowBox[{
         RowBox[{"a1", " ", 
          RowBox[{"D", "[", 
           RowBox[{"#", ",", 
            RowBox[{"{", 
             RowBox[{"x", ",", "2"}], "}"}]}], "]"}]}], " ", "+", " ", 
         RowBox[{"a2", " ", 
          RowBox[{"(", 
           RowBox[{
            SuperscriptBox["ubar", "2"], "+", 
            SuperscriptBox["vbar", "2"]}], ")"}], "#"}]}], ")"}]}], ")"}], 
     "&"}]}], ";"}], " "}]], "Input",
 CellChangeTimes->{{3.667324276565543*^9, 3.667324276565906*^9}, {
   3.667324306830727*^9, 3.667324437967402*^9}, {3.667324575137847*^9, 
   3.6673245847137747`*^9}, {3.667324628962173*^9, 3.667324632234043*^9}, {
   3.6673246826666393`*^9, 3.66732468618653*^9}, {3.667324807349028*^9, 
   3.6673248439976587`*^9}, {3.66732495426289*^9, 3.667324969550634*^9}, 
   3.667325145921352*^9, {3.667509016285833*^9, 3.667509016340904*^9}, {
   3.667513151953751*^9, 3.667513212010523*^9}, 3.667513461487884*^9, {
   3.6698283893045197`*^9, 3.669828402208399*^9}, 3.669828578173654*^9, 
   3.669828791706686*^9, 3.66982887614097*^9, 3.669829003582036*^9, {
   3.6698340720086823`*^9, 3.669834080406878*^9}, {3.6698361319739647`*^9, 
   3.66983614353862*^9}, {3.6698370536781178`*^9, 3.669837061397086*^9}, {
   3.669838379241069*^9, 3.669838390180318*^9}, {3.670976031592621*^9, 
   3.670976043120275*^9}, {3.7070763740281687`*^9, 3.7070763743283663`*^9}, {
   3.707076404676551*^9, 3.7070764787799873`*^9}, {3.7070765536003942`*^9, 
   3.707076610855998*^9}, 3.7070766409097433`*^9, 3.7070767662234373`*^9, {
   3.70748925679431*^9, 3.70748926640024*^9}, {3.707489358626433*^9, 
   3.707489366091058*^9}, {3.7078415054703617`*^9, 3.707841534222466*^9}, {
   3.709154042992003*^9, 3.709154043478511*^9}, {3.709154076167824*^9, 
   3.709154090831695*^9}, {3.709238972435656*^9, 3.709238990697522*^9}, {
   3.7093862766078587`*^9, 3.7093863491657476`*^9}, {3.709398007366722*^9, 
   3.709398026614663*^9}, {3.710197631496011*^9, 3.710197661152776*^9}, {
   3.7101977362675257`*^9, 3.710197896779047*^9}, {3.710198115856016*^9, 
   3.7101981599094143`*^9}, {3.710198857850107*^9, 3.7101989297773037`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"--", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", "-"}]}]}]}]}]}]}]}]}]}]}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", " ", 
       RowBox[{
        RowBox[{
         RowBox[{"Kernels", " ", "--"}], "--"}], "--"}]}]}]}], "-"}], " ", 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"--", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"-", 
            RowBox[{"--", 
             RowBox[{"--", "--"}]}]}]}]}]}]}]}]}]}]}], " ", "*)"}]}]], "Input",\

 CellChangeTimes->{{3.7098613515740643`*^9, 3.709861364079505*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ku", " ", "=", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"Exp", "[", "logsigmau", "]"}], " ", 
     RowBox[{"Exp", "[", 
      RowBox[{
       RowBox[{"-", 
        FractionBox["1", "2"]}], " ", 
       FractionBox[
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"x", "-", "xp"}], ")"}], "2"], 
        RowBox[{"Exp", "[", "logthetau", "]"}]]}], "]"}]}], "//", 
    "Simplify"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"kv", " ", "=", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"Exp", "[", "logsigmav", "]"}], " ", 
     RowBox[{"Exp", "[", 
      RowBox[{
       RowBox[{"-", 
        FractionBox["1", "2"]}], " ", 
       FractionBox[
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"x", "-", "xp"}], ")"}], "2"], 
        RowBox[{"Exp", "[", "logthetav", "]"}]]}], "]"}]}], "//", 
    "Simplify"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.667324987770883*^9, 3.667325028823172*^9}, 
   3.6673252058734207`*^9, 3.667513214009428*^9, 3.66751346373457*^9, {
   3.667514488963458*^9, 3.667514513612434*^9}, {3.667514570646639*^9, 
   3.6675145879898367`*^9}, {3.667515335419985*^9, 3.667515380653713*^9}, {
   3.667516355329999*^9, 3.667516355825122*^9}, {3.667516399811775*^9, 
   3.66751641255346*^9}, {3.6698291776817417`*^9, 3.669829177737496*^9}, {
   3.6739932585480757`*^9, 3.6739932587067223`*^9}, {3.707076619799995*^9, 
   3.707076629959457*^9}, {3.707847615841587*^9, 3.7078476814523697`*^9}, 
   3.7078477420972033`*^9, {3.707847774481147*^9, 3.707847776183857*^9}, {
   3.707848948535215*^9, 3.707849017929492*^9}, {3.7078498231505623`*^9, 
   3.707849823622776*^9}, 3.7078506094714527`*^9, {3.7078556216810913`*^9, 
   3.707855672326655*^9}, 3.7078557138303127`*^9, 3.707855847324168*^9, {
   3.709157175937554*^9, 3.7091571854002657`*^9}, {3.70915725165005*^9, 
   3.709157254797662*^9}, 3.7091578347543983`*^9, {3.7091580127744293`*^9, 
   3.709158021604108*^9}, {3.7092358453858223`*^9, 3.709235862006452*^9}, {
   3.709238670984864*^9, 3.709238675632432*^9}, {3.7092389662729883`*^9, 
   3.709238966343399*^9}, 3.709239395109068*^9, 3.70931278066439*^9, 
   3.709313903654407*^9, 3.710197691562442*^9, {3.710198226681407*^9, 
   3.710198278027974*^9}}],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{"--", 
   RowBox[{"--", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", "--"}]}]}]}]}]}]}]}]}]}]}]}], " ", "*)"}]], "Input",\

 CellChangeTimes->{{3.7091586073489923`*^9, 3.709158612305133*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ku1u1", " ", "=", " ", 
   RowBox[{"ku", "//", "Simplify"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"kv1v1", " ", "=", " ", 
   RowBox[{"kv", "//", "Simplify"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.709158265788355*^9, 3.7091582984804363`*^9}, {
   3.709239008708089*^9, 3.709239011172249*^9}, 3.709239395139275*^9, {
   3.709312387321686*^9, 3.709312393082288*^9}, {3.709312782930209*^9, 
   3.709312785058531*^9}, 3.710197691571287*^9, {3.7101983542152367`*^9, 
   3.710198385104684*^9}}],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{"--", 
   RowBox[{"--", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", "--"}]}]}]}]}]}]}]}]}]}]}]}], " ", "*)"}]], "Input"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ku1u0", " ", "=", " ", 
   RowBox[{"ku", "//", "Simplify"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ku1v0", " ", "=", " ", 
   RowBox[{
    RowBox[{"-", 
     RowBox[{
      RowBox[{"L", "[", 
       RowBox[{"xp", ",", "ubarp", ",", "vbarp"}], "]"}], "[", "ku", "]"}]}], 
    "//", "Simplify"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"kv1u0", " ", "=", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"L", "[", 
      RowBox[{"xp", ",", "ubarp", ",", "vbarp"}], "]"}], "[", "kv", "]"}], "//",
     "Simplify"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"kv1v0", " ", "=", " ", 
   RowBox[{"kv", "//", "Simplify"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.7094906185646763`*^9, 3.709490667919038*^9}, {
   3.70949073824224*^9, 3.709490753002617*^9}, {3.7094907882431593`*^9, 
   3.709490812017334*^9}, {3.709490981922971*^9, 3.709490982239146*^9}, {
   3.7094910914991426`*^9, 3.7094910943046293`*^9}, 3.7094936554464207`*^9, {
   3.709856575218665*^9, 3.709856588325864*^9}, {3.710171515503441*^9, 
   3.7101715269685917`*^9}, {3.7101819101404543`*^9, 
   3.7101819124432898`*^9}, {3.710198447760414*^9, 3.710198505129196*^9}, {
   3.710198988955336*^9, 3.71019903885982*^9}, {3.710199120762862*^9, 
   3.710199121602447*^9}}],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{"--", 
   RowBox[{"--", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", "--"}]}]}]}]}]}]}]}]}]}]}]}], " ", "*)"}]], "Input",\

 CellChangeTimes->{{3.7091586073489923`*^9, 3.709158612305133*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ku0u0", " ", "=", " ", 
   RowBox[{
    RowBox[{"ku", "+", " ", 
     RowBox[{
      RowBox[{"L", "[", 
       RowBox[{"x", ",", "ubar", ",", "vbar"}], "]"}], "[", 
      RowBox[{
       RowBox[{"L", "[", 
        RowBox[{"xp", ",", "ubarp", ",", "vbarp"}], "]"}], "[", "kv", "]"}], 
      "]"}]}], "//", "Simplify"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ku0v0", " ", "=", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"-", 
      RowBox[{
       RowBox[{"L", "[", 
        RowBox[{"xp", ",", "ubarp", ",", "vbarp"}], "]"}], "[", "ku", "]"}]}],
      "+", 
     RowBox[{
      RowBox[{"L", "[", 
       RowBox[{"x", ",", "ubar", ",", "vbar"}], "]"}], "[", "kv", "]"}]}], "//",
     "Simplify"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"kv0v0", " ", "=", " ", 
   RowBox[{
    RowBox[{"kv", "+", 
     RowBox[{
      RowBox[{"L", "[", 
       RowBox[{"x", ",", "ubar", ",", "vbar"}], "]"}], "[", 
      RowBox[{
       RowBox[{"L", "[", 
        RowBox[{"xp", ",", "ubarp", ",", "vbarp"}], "]"}], "[", "ku", "]"}], 
      "]"}]}], "//", "Simplify"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.709491290143755*^9, 3.709491374552648*^9}, 
   3.709491446421207*^9, 3.709493655506317*^9, {3.709856649101693*^9, 
   3.709856655716785*^9}, {3.710171848829577*^9, 3.7101718614924994`*^9}, {
   3.7101819133663197`*^9, 3.710181918921898*^9}, {3.7101991630436563`*^9, 
   3.710199330035981*^9}, {3.710199847953588*^9, 3.710199889036261*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"--", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", "--"}]}]}]}]}]}]}]}]}]}]}]}]}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", " ", 
       RowBox[{
        RowBox[{
         RowBox[{"Derivatives", " ", "--"}], "--"}], "--"}]}]}]}], "-"}], " ",
    "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"--", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", "--"}]}]}]}]}]}]}]}]}]}]}]}]}], " ", 
   "*)"}]}]], "Input",
 CellChangeTimes->{{3.7098566672195463`*^9, 3.709856673734831*^9}, {
  3.709860731720688*^9, 3.709860739696417*^9}, {3.709861295781282*^9, 
  3.709861306339994*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"kernels", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
    "\"\<ku1u1\>\"", ",", "\"\<kv1v1\>\"", ",", "\"\<ku1u0\>\"", ",", 
     "\"\<ku1v0\>\"", ",", " ", "\"\<kv1u0\>\"", ",", "\"\<kv1v0\>\"", ",", 
     "\"\<ku0u0\>\"", ",", "\"\<ku0v0\>\"", ",", " ", "\"\<kv0v0\>\""}], 
    "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"params", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
    "\"\<logsigmau\>\"", ",", "\"\<logthetau\>\"", ",", "\"\<logsigmav\>\"", 
     ",", "\"\<logthetav\>\"", ",", "\"\<a1\>\"", ",", "\"\<a2\>\""}], 
    "}"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.709860851295492*^9, 3.709860852621336*^9}, {
   3.70986114779635*^9, 3.709861148356244*^9}, {3.7098612236867*^9, 
   3.7098612319370527`*^9}, {3.710077914342486*^9, 3.710077914710106*^9}, {
   3.710167722253644*^9, 3.710167725244874*^9}, {3.710168614089562*^9, 
   3.710168614528391*^9}, {3.710171892142473*^9, 3.7101719158602543`*^9}, {
   3.710173091825407*^9, 3.710173099691551*^9}, {3.7101738603663187`*^9, 
   3.710173866299038*^9}, {3.710179591419241*^9, 3.71017959182725*^9}, 
   3.710182056168997*^9, {3.7101859989177856`*^9, 3.710186001628439*^9}, {
   3.710186419599283*^9, 3.71018641978865*^9}, {3.710199959249597*^9, 
   3.710200027969208*^9}, {3.710201503114498*^9, 3.710201507139236*^9}}],

Cell[BoxData[
 RowBox[{"For", "[", 
  RowBox[{
   RowBox[{"i", "=", "1"}], ",", 
   RowBox[{"i", "<=", 
    RowBox[{"Length", "[", "params", "]"}]}], ",", 
   RowBox[{"i", "++"}], ",", 
   RowBox[{"For", "[", 
    RowBox[{
     RowBox[{"j", "=", "1"}], ",", 
     RowBox[{"j", "<=", 
      RowBox[{"Length", "[", "kernels", "]"}]}], ",", 
     RowBox[{"j", "++"}], ",", 
     RowBox[{"ToExpression", "[", 
      RowBox[{"\"\<D\>\"", "<>", 
       RowBox[{"kernels", "[", 
        RowBox[{"[", "j", "]"}], "]"}], "<>", "\"\<D\>\"", "<>", 
       RowBox[{"params", "[", 
        RowBox[{"[", "i", "]"}], "]"}], "<>", "\"\< = D[\>\"", "<>", 
       RowBox[{"kernels", "[", 
        RowBox[{"[", "j", "]"}], "]"}], "<>", "\"\<,\>\"", "<>", 
       RowBox[{"params", "[", 
        RowBox[{"[", "i", "]"}], "]"}], "<>", "\"\<]//Simplify;\>\""}], 
      "]"}]}], "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{
      RowBox[{"Dku1u1Dlogsigma", "=", 
       RowBox[{
        RowBox[{"D", "[", 
         RowBox[{"ku1u1", ",", "logsigma"}], "]"}], "//", "Simplify"}]}], 
      ";"}], "*)"}], "]"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.7098611341209393`*^9, 3.709861134121271*^9}, {
  3.7098612196273727`*^9, 3.709861243687777*^9}, {3.709861387144882*^9, 
  3.709861403792614*^9}, {3.7098615067166243`*^9, 3.7098615173748007`*^9}, {
  3.7098616711765633`*^9, 3.7098616736462517`*^9}, {3.70990005927768*^9, 
  3.709900112776325*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"--", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", "--"}]}]}]}]}]}]}]}]}]}]}]}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"--", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"-", " ", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"ToMatlab", " ", "--"}], "--"}], "--"}], "--"}]}]}]}]}], 
   " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"--", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", "--"}]}]}]}]}]}]}]}]}]}]}]}], " ", 
   "*)"}]}]], "Input",
 CellChangeTimes->{{3.709855803830974*^9, 3.709855809451151*^9}, {
  3.7098561431608*^9, 3.7098561489935293`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"dir", " ", "=", " ", 
   RowBox[{"Dir", "<>", "\"\</+k11\>\""}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SetDirectory", "[", "dir", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Directory", "[", "]"}]}], "Input",
 CellChangeTimes->{{3.709854391711301*^9, 3.709854404970632*^9}, {
   3.7098544548837423`*^9, 3.7098544614917727`*^9}, {3.709855777863822*^9, 
   3.709855794645458*^9}, {3.709855986109836*^9, 3.709856001621396*^9}, 
   3.710200209727084*^9, {3.710252758881815*^9, 3.7102527620743*^9}}],

Cell[BoxData["\<\"/users/mraissi/Desktop/HiddenPhysicsModel/Kernels/\
Schrodinger/+k11\"\>"], "Output",
 CellChangeTimes->{
  3.709856016833329*^9, 3.709858792925148*^9, 3.709861431527484*^9, 
   3.709861589187956*^9, 3.709861865195856*^9, 3.709901365317595*^9, 
   3.70990186293526*^9, 3.7099022777489023`*^9, 3.7099023580866632`*^9, 
   3.709902410965639*^9, 3.709902455171795*^9, 3.7099031599394484`*^9, 
   3.7100781792373943`*^9, 3.7101636512703133`*^9, 3.710167860349411*^9, 
   3.710168729213357*^9, 3.710169663152247*^9, 3.710170146420598*^9, 
   3.710170955550418*^9, 3.710172125701661*^9, 3.7101732736743813`*^9, 
   3.710173996318903*^9, 3.710177790104217*^9, 3.710179720659617*^9, 
   3.7101821687704163`*^9, 3.710183046618907*^9, 3.7101833170236464`*^9, 
   3.7101835779776382`*^9, 3.710184106898366*^9, 3.7101845262654877`*^9, 
   3.710185068322246*^9, 3.710185224792987*^9, 3.710185635744013*^9, 
   3.7101861078281612`*^9, 3.71018632325954*^9, 3.7101865029096727`*^9, 
   3.710186701401167*^9, 3.710187195689536*^9, 3.710187349603945*^9, 
   3.710187575687366*^9, 3.710200226354895*^9, 3.710200318482197*^9, 
   3.71020048506102*^9, {3.710200726773004*^9, 3.710200751956122*^9}, {
   3.710200880462461*^9, 3.710200926682695*^9}, 3.710201085507339*^9, 
   3.710201184971158*^9, 3.7102015176034307`*^9, 3.7102018114129543`*^9, 
   3.710202087559313*^9, 3.710202934943758*^9, 3.710204389526952*^9, 
   3.710252791774199*^9, 3.7102571654258842`*^9, 3.7102611872721243`*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"--", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", "--"}]}]}]}]}]}]}]}]}]}]}]}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"-", 
        RowBox[{"--", " ", 
         RowBox[{"+", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"k11", " ", "--"}], "--"}], "--"}], "--"}]}]}]}]}]}]}], 
    "--"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"--", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", "--"}]}]}]}]}]}]}]}]}]}]}]}], " ", 
   "*)"}]}]], "Input",
 CellChangeTimes->{{3.709855695885346*^9, 3.709855712319416*^9}, {
  3.7099025638700314`*^9, 3.709902568293578*^9}, {3.709902598736709*^9, 
  3.709902602010173*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"kernels", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{"\"\<ku1u1\>\"", ",", " ", "\"\<kv1v1\>\""}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"params", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
    "\"\<logsigmau\>\"", ",", "\"\<logthetau\>\"", ",", "\"\<logsigmav\>\"", 
     ",", "\"\<logthetav\>\""}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"For", "[", 
  RowBox[{
   RowBox[{"i", "=", "1"}], ",", 
   RowBox[{"i", "<=", 
    RowBox[{"Length", "[", "kernels", "]"}]}], ",", 
   RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"f", " ", "=", " ", 
     RowBox[{"OpenWrite", "[", " ", 
      RowBox[{
       RowBox[{"kernels", "[", 
        RowBox[{"[", "i", "]"}], "]"}], "<>", "\"\<.m\>\""}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"WriteLine", "[", 
     RowBox[{"f", ",", " ", 
      RowBox[{"\"\<function [K] = \>\"", "<>", 
       RowBox[{"kernels", "[", 
        RowBox[{"[", "i", "]"}], "]"}], "<>", 
       "\"\<(x, xp, hyp, i)\n\nlogsigmau = hyp(1);\nlogthetau = hyp(2);\n\
logsigmav = hyp(3);\nlogthetav = hyp(4);\n\nn_x = size(x,1);\nn_xp = \
size(xp,1);\n\nx = repmat(x,1,n_xp);\nxp = repmat(xp',n_x,1);\n\nswitch \
i\>\""}]}], "]"}], ";", "\[IndentingNewLine]", 
    RowBox[{"WriteMatlab", "[", 
     RowBox[{
      RowBox[{"ToExpression", "[", 
       RowBox[{"kernels", "[", 
        RowBox[{"[", "i", "]"}], "]"}], "]"}], ",", "f", ",", 
      "\"\<\\n\\ncase 0\\n\\nK\>\""}], "]"}], ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"j", "=", "1"}], ",", 
       RowBox[{"j", "<=", 
        RowBox[{"Length", "[", "params", "]"}]}], ",", 
       RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"WriteMatlab", "[", 
         RowBox[{
          RowBox[{"ToExpression", "[", 
           RowBox[{"\"\<D\>\"", "<>", 
            RowBox[{"kernels", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "<>", "\"\<D\>\"", "<>", 
            RowBox[{"params", "[", 
             RowBox[{"[", "j", "]"}], "]"}]}], "]"}], ",", "f", ",", 
          RowBox[{"\"\<\\n\\ncase \>\"", "<>", 
           RowBox[{"ToString", "[", "j", "]"}], "<>", " ", "\"\< % \>\"", "<>", 
           RowBox[{"params", "[", 
            RowBox[{"[", "j", "]"}], "]"}], "<>", "\"\<\\n\\nK\>\""}]}], 
         "]"}], ";"}]}], "]"}], "\[IndentingNewLine]", 
     RowBox[{"WriteLine", "[", 
      RowBox[{
      "f", ",", 
       "\"\<\\n\\notherwise\n        \n        K = zeros(n_x, n_xp);\nend\n\n\
if K == 0\n\n    K = zeros(n_x, n_xp);\n\nend\n\nend\>\""}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"Close", "[", "f", "]"}], ";"}]}], "\[IndentingNewLine]", 
  "]"}]}], "Input",
 CellChangeTimes->{{3.7099003009768553`*^9, 3.709900448050478*^9}, {
   3.7099005020926447`*^9, 3.709900529447152*^9}, {3.709900561836616*^9, 
   3.7099008331914673`*^9}, {3.70990090623285*^9, 3.709900940622374*^9}, {
   3.709900975802902*^9, 3.709901017021534*^9}, 3.709901075170909*^9, {
   3.7099011131210203`*^9, 3.7099011494937267`*^9}, {3.7099013855908947`*^9, 
   3.70990138707374*^9}, {3.7099016030524473`*^9, 3.709901605852652*^9}, {
   3.709901773882999*^9, 3.709901833564787*^9}, {3.709902258182642*^9, 
   3.709902261102006*^9}, 3.7099023421429977`*^9, {3.709902397123823*^9, 
   3.709902404220764*^9}, 3.7099030632759123`*^9, {3.710200370085404*^9, 
   3.710200375295823*^9}, {3.7102004117037773`*^9, 3.710200470463009*^9}, {
   3.7102006946047287`*^9, 3.710200737294903*^9}, {3.710200847194714*^9, 
   3.710200849753172*^9}, {3.710200944435478*^9, 3.710201081384659*^9}, {
   3.710201179205122*^9, 3.710201180463876*^9}, 3.710201319530642*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"--", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", "--"}]}]}]}]}]}]}]}]}]}]}]}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"--", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"-", " ", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"ToMatlab", " ", "--"}], "--"}], "--"}], "--"}]}]}]}]}], 
   " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"--", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", "--"}]}]}]}]}]}]}]}]}]}]}]}], " ", 
   "*)"}]}]], "Input",
 CellChangeTimes->{{3.709855803830974*^9, 3.709855809451151*^9}, {
  3.7098561431608*^9, 3.7098561489935293`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"dir", " ", "=", " ", 
   RowBox[{"Dir", "<>", "\"\</+k10\>\""}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SetDirectory", "[", "dir", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Directory", "[", "]"}]}], "Input",
 CellChangeTimes->{{3.709854391711301*^9, 3.709854404970632*^9}, {
   3.7098544548837423`*^9, 3.7098544614917727`*^9}, {3.709855777863822*^9, 
   3.709855794645458*^9}, {3.709855986109836*^9, 3.709856001621396*^9}, 
   3.710200209727084*^9, {3.710201469815246*^9, 3.710201469924164*^9}, {
   3.710252770017147*^9, 3.710252772184843*^9}}],

Cell[BoxData["\<\"/users/mraissi/Desktop/HiddenPhysicsModel/Kernels/\
Schrodinger/+k10\"\>"], "Output",
 CellChangeTimes->{3.710201518298656*^9, 3.7102018119620028`*^9, 
  3.710202088073242*^9, 3.710202935545907*^9, 3.71020439003296*^9, 
  3.710252792318366*^9, 3.710257165952532*^9, 3.710261187969715*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"--", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", "--"}]}]}]}]}]}]}]}]}]}]}]}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"--", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"-", 
       RowBox[{"--", " ", 
        RowBox[{"+", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"k10", " ", "--"}], "--"}], "--"}], "--"}], 
          "--"}]}]}]}]}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"--", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", "--"}]}]}]}]}]}]}]}]}]}]}]}], " ", 
   "*)"}]}]], "Input",
 CellChangeTimes->{{3.709855695885346*^9, 3.709855712319416*^9}, {
  3.7099025638700314`*^9, 3.709902568293578*^9}, {3.709902598736709*^9, 
  3.709902602010173*^9}, {3.709902696640339*^9, 3.709902696975821*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"kernels", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
    "\"\<ku1u0\>\"", ",", "\"\<ku1v0\>\"", ",", " ", "\"\<kv1u0\>\"", ",", 
     "\"\<kv1v0\>\""}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"params", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
    "\"\<logsigmau\>\"", ",", "\"\<logthetau\>\"", ",", " ", 
     "\"\<logsigmav\>\"", ",", "\"\<logthetav\>\"", ",", "\"\<a1\>\"", ",", 
     "\"\<a2\>\""}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"For", "[", 
  RowBox[{
   RowBox[{"i", "=", "1"}], ",", 
   RowBox[{"i", "<=", 
    RowBox[{"Length", "[", "kernels", "]"}]}], ",", 
   RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"f", " ", "=", " ", 
     RowBox[{"OpenWrite", "[", " ", 
      RowBox[{
       RowBox[{"kernels", "[", 
        RowBox[{"[", "i", "]"}], "]"}], "<>", "\"\<.m\>\""}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"WriteLine", "[", 
     RowBox[{"f", ",", " ", 
      RowBox[{"\"\<function [K] = \>\"", "<>", 
       RowBox[{"kernels", "[", 
        RowBox[{"[", "i", "]"}], "]"}], "<>", 
       "\"\<(x, xp, hyp, ubarp, vbarp, dt, i)\n\nlogsigmau = hyp(1);\n\
logthetau = hyp(2);\nlogsigmav = hyp(3);\nlogthetav = hyp(4);\n\na1 = hyp(5);\
\na2 = hyp(6);\n\nn_x = size(x,1);\nn_xp = size(xp,1);\n\nx = \
repmat(x,1,n_xp);\nxp = repmat(xp',n_x,1);\n\nubarp = repmat(ubarp',n_x,1);\n\
vbarp = repmat(vbarp',n_x,1);\n\nswitch i\>\""}]}], "]"}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"WriteMatlab", "[", 
     RowBox[{
      RowBox[{"ToExpression", "[", 
       RowBox[{"kernels", "[", 
        RowBox[{"[", "i", "]"}], "]"}], "]"}], ",", "f", ",", 
      "\"\<\\n\\ncase 0\\n\\nK\>\""}], "]"}], ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"j", "=", "1"}], ",", 
       RowBox[{"j", "<=", 
        RowBox[{"Length", "[", "params", "]"}]}], ",", 
       RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"WriteMatlab", "[", 
         RowBox[{
          RowBox[{"ToExpression", "[", 
           RowBox[{"\"\<D\>\"", "<>", 
            RowBox[{"kernels", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "<>", "\"\<D\>\"", "<>", 
            RowBox[{"params", "[", 
             RowBox[{"[", "j", "]"}], "]"}]}], "]"}], ",", "f", ",", 
          RowBox[{"\"\<\\n\\ncase \>\"", "<>", 
           RowBox[{"ToString", "[", "j", "]"}], "<>", " ", "\"\< % \>\"", "<>", 
           RowBox[{"params", "[", 
            RowBox[{"[", "j", "]"}], "]"}], "<>", "\"\<\\n\\nK\>\""}]}], 
         "]"}], ";"}]}], "]"}], "\[IndentingNewLine]", 
     RowBox[{"WriteLine", "[", 
      RowBox[{
      "f", ",", 
       "\"\<\\n\\notherwise\n        \n        K = zeros(n_x, n_xp);\nend\n\n\
if K == 0\n\n    K = zeros(n_x, n_xp);\n\nend\n\nend\>\""}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"Close", "[", "f", "]"}], ";"}]}], "\[IndentingNewLine]", 
  "]"}]}], "Input",
 CellChangeTimes->{{3.7099003009768553`*^9, 3.709900448050478*^9}, {
   3.7099005020926447`*^9, 3.709900529447152*^9}, {3.709900561836616*^9, 
   3.7099008331914673`*^9}, {3.70990090623285*^9, 3.709900940622374*^9}, {
   3.709900975802902*^9, 3.709901017021534*^9}, 3.709901075170909*^9, {
   3.7099011131210203`*^9, 3.7099011494937267`*^9}, {3.7099013855908947`*^9, 
   3.70990138707374*^9}, {3.7099016030524473`*^9, 3.709901605852652*^9}, {
   3.709901773882999*^9, 3.709901833564787*^9}, {3.709902258182642*^9, 
   3.709902261102006*^9}, 3.7099023421429977`*^9, {3.709902397123823*^9, 
   3.709902404220764*^9}, {3.709902706248199*^9, 3.709902742194319*^9}, 
   3.709902785913021*^9, 3.709903056988*^9, {3.710077936487534*^9, 
   3.710077936777623*^9}, {3.710078026214858*^9, 3.710078026654572*^9}, {
   3.7101677524247828`*^9, 3.710167757878373*^9}, {3.710168626894661*^9, 
   3.710168634076165*^9}, {3.710171945746797*^9, 3.710172002042344*^9}, {
   3.7101731243532677`*^9, 3.7101731383496637`*^9}, {3.7101738734030027`*^9, 
   3.7101738860565653`*^9}, {3.71017961684448*^9, 3.710179621803624*^9}, {
   3.710182066083228*^9, 3.7101820731344757`*^9}, {3.710186008612764*^9, 
   3.710186043226886*^9}, {3.7101864390445538`*^9, 3.710186441866074*^9}, {
   3.710201213216387*^9, 3.7102012642079268`*^9}, {3.710201340373643*^9, 
   3.7102014214574223`*^9}, {3.710204367636354*^9, 3.7102043680580683`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"--", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", "--"}]}]}]}]}]}]}]}]}]}]}]}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"--", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"-", " ", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"ToMatlab", " ", "--"}], "--"}], "--"}], "--"}]}]}]}]}], 
   " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"--", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", "--"}]}]}]}]}]}]}]}]}]}]}]}], " ", 
   "*)"}]}]], "Input",
 CellChangeTimes->{{3.709855803830974*^9, 3.709855809451151*^9}, {
  3.7098561431608*^9, 3.7098561489935293`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"dir", " ", "=", " ", 
   RowBox[{"Dir", "<>", "\"\</+k00\>\""}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SetDirectory", "[", "dir", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Directory", "[", "]"}]}], "Input",
 CellChangeTimes->{{3.709854391711301*^9, 3.709854404970632*^9}, {
   3.7098544548837423`*^9, 3.7098544614917727`*^9}, {3.709855777863822*^9, 
   3.709855794645458*^9}, {3.709855986109836*^9, 3.709856001621396*^9}, 
   3.710200209727084*^9, {3.710201469815246*^9, 3.710201469924164*^9}, {
   3.710201726732162*^9, 3.710201726832575*^9}, {3.710252778618402*^9, 
   3.710252780962081*^9}}],

Cell[BoxData["\<\"/users/mraissi/Desktop/HiddenPhysicsModel/Kernels/\
Schrodinger/+k00\"\>"], "Output",
 CellChangeTimes->{3.710201518298656*^9, 3.710201812286574*^9, 
  3.7102020882897778`*^9, 3.710202935939595*^9, 3.710204390244649*^9, 
  3.71025279256273*^9, 3.710257166207391*^9, 3.710261188416422*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"--", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", "--"}]}]}]}]}]}]}]}]}]}]}]}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"--", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"-", 
       RowBox[{"--", " ", 
        RowBox[{"+", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"k00", " ", "--"}], "--"}], "--"}], "--"}], 
          "--"}]}]}]}]}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"--", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", "--"}]}]}]}]}]}]}]}]}]}]}]}], " ", 
   "*)"}]}]], "Input",
 CellChangeTimes->{{3.709855695885346*^9, 3.709855712319416*^9}, {
  3.7099025638700314`*^9, 3.709902568293578*^9}, {3.709902598736709*^9, 
  3.709902602010173*^9}, {3.709902696640339*^9, 3.709902696975821*^9}, {
  3.709902895539709*^9, 3.7099028956260443`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"kernels", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{"\"\<ku0u0\>\"", ",", "\"\<ku0v0\>\"", ",", "\"\<kv0v0\>\""}], 
    "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"params", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
    "\"\<logsigmau\>\"", ",", "\"\<logthetau\>\"", ",", " ", 
     "\"\<logsigmav\>\"", ",", "\"\<logthetav\>\"", ",", "\"\<a1\>\"", ",", 
     "\"\<a2\>\""}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"For", "[", 
  RowBox[{
   RowBox[{"i", "=", "1"}], ",", 
   RowBox[{"i", "<=", 
    RowBox[{"Length", "[", "kernels", "]"}]}], ",", 
   RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"f", " ", "=", " ", 
     RowBox[{"OpenWrite", "[", " ", 
      RowBox[{
       RowBox[{"kernels", "[", 
        RowBox[{"[", "i", "]"}], "]"}], "<>", "\"\<.m\>\""}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"WriteLine", "[", 
     RowBox[{"f", ",", " ", 
      RowBox[{"\"\<function [K] = \>\"", "<>", 
       RowBox[{"kernels", "[", 
        RowBox[{"[", "i", "]"}], "]"}], "<>", 
       "\"\<(x, xp, hyp, ubar, vbar, ubarp, vbarp, dt, i)\n\nlogsigmau = \
hyp(1);\nlogthetau = hyp(2);\nlogsigmav = hyp(3);\nlogthetav = hyp(4);\n\na1 \
= hyp(5);\na2 = hyp(6);\n\nn_x = size(x,1);\nn_xp = size(xp,1);\n\nx = \
repmat(x,1,n_xp);\nxp = repmat(xp',n_x,1);\n\nubar = repmat(ubar,1,n_xp);\n\
vbar = repmat(vbar,1,n_xp);\nubarp = repmat(ubarp',n_x,1);\nvbarp = \
repmat(vbarp',n_x,1);\n\nswitch i\>\""}]}], "]"}], ";", "\[IndentingNewLine]", 
    RowBox[{"WriteMatlab", "[", 
     RowBox[{
      RowBox[{"ToExpression", "[", 
       RowBox[{"kernels", "[", 
        RowBox[{"[", "i", "]"}], "]"}], "]"}], ",", "f", ",", 
      "\"\<\\n\\ncase 0\\n\\nK\>\""}], "]"}], ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"j", "=", "1"}], ",", 
       RowBox[{"j", "<=", 
        RowBox[{"Length", "[", "params", "]"}]}], ",", 
       RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"WriteMatlab", "[", 
         RowBox[{
          RowBox[{"ToExpression", "[", 
           RowBox[{"\"\<D\>\"", "<>", 
            RowBox[{"kernels", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "<>", "\"\<D\>\"", "<>", 
            RowBox[{"params", "[", 
             RowBox[{"[", "j", "]"}], "]"}]}], "]"}], ",", "f", ",", 
          RowBox[{"\"\<\\n\\ncase \>\"", "<>", 
           RowBox[{"ToString", "[", "j", "]"}], "<>", " ", "\"\< % \>\"", "<>", 
           RowBox[{"params", "[", 
            RowBox[{"[", "j", "]"}], "]"}], "<>", "\"\<\\n\\nK\>\""}]}], 
         "]"}], ";"}]}], "]"}], "\[IndentingNewLine]", 
     RowBox[{"WriteLine", "[", 
      RowBox[{
      "f", ",", 
       "\"\<\\n\\notherwise\n        \n        K = zeros(n_x, n_xp);\nend\n\n\
if K == 0\n\n    K = zeros(n_x, n_xp);\n\nend\n\nend\>\""}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"Close", "[", "f", "]"}], ";"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.7099003009768553`*^9, 3.709900448050478*^9}, {
   3.7099005020926447`*^9, 3.709900529447152*^9}, {3.709900561836616*^9, 
   3.7099008331914673`*^9}, {3.70990090623285*^9, 3.709900940622374*^9}, {
   3.709900975802902*^9, 3.709901017021534*^9}, 3.709901075170909*^9, {
   3.7099011131210203`*^9, 3.7099011494937267`*^9}, {3.7099013855908947`*^9, 
   3.70990138707374*^9}, {3.7099016030524473`*^9, 3.709901605852652*^9}, {
   3.709901773882999*^9, 3.709901833564787*^9}, {3.709902258182642*^9, 
   3.709902261102006*^9}, 3.7099023421429977`*^9, {3.709902397123823*^9, 
   3.709902404220764*^9}, {3.709902706248199*^9, 3.709902742194319*^9}, 
   3.709902785913021*^9, {3.709902902691422*^9, 3.709902930371571*^9}, 
   3.709902961754245*^9, 3.709903035226801*^9, {3.710077944631298*^9, 
   3.710077944834075*^9}, {3.710078032273769*^9, 3.710078032673998*^9}, {
   3.7100780822969437`*^9, 3.710078086363625*^9}, {3.710167774343186*^9, 
   3.710167778543366*^9}, {3.710168642391868*^9, 3.7101686472922363`*^9}, {
   3.710172019856057*^9, 3.710172041484332*^9}, {3.7101731646293573`*^9, 
   3.710173175603344*^9}, {3.710173890694257*^9, 3.710173902962987*^9}, {
   3.710179629574792*^9, 3.7101796447337523`*^9}, {3.7101820781540813`*^9, 
   3.7101820895137463`*^9}, {3.710186018592371*^9, 3.710186036635291*^9}, {
   3.710186446332748*^9, 3.710186450225832*^9}, {3.710186543038028*^9, 
   3.710186546513776*^9}, {3.710201646187049*^9, 3.710201676841926*^9}, {
   3.7102017371476583`*^9, 3.710201799209187*^9}, {3.710204377178187*^9, 
   3.7102043800670633`*^9}}]
},
WindowSize->{1196, 1792},
WindowMargins->{{Automatic, 0}, {Automatic, 0}},
FrontEndVersion->"10.0 for Linux x86 (64-bit) (June 27, 2014)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 1285, 44, 77, "Input"],
Cell[1846, 66, 138, 3, 32, "Input"],
Cell[1987, 71, 1069, 39, 77, "Input"],
Cell[3059, 112, 327, 8, 32, "Input"],
Cell[3389, 122, 1035, 38, 77, "Input"],
Cell[4427, 162, 2348, 44, 35, "Input"],
Cell[6778, 208, 1003, 37, 77, "Input"],
Cell[7784, 247, 2259, 49, 116, "Input"],
Cell[10046, 298, 426, 15, 32, "Input"],
Cell[10475, 315, 545, 11, 55, "Input"],
Cell[11023, 328, 356, 13, 32, "Input"],
Cell[11382, 343, 1302, 30, 99, "Input"],
Cell[12687, 375, 426, 15, 32, "Input"],
Cell[13116, 392, 1497, 40, 77, "Input"],
Cell[14616, 434, 1235, 43, 77, "Input"],
Cell[15854, 479, 1339, 25, 55, "Input"],
Cell[17196, 506, 1435, 35, 99, "Input"],
Cell[18634, 543, 1144, 41, 77, "Input"],
Cell[CellGroupData[{
Cell[19803, 588, 550, 10, 77, "Input"],
Cell[20356, 600, 1485, 21, 32, "Output"]
}, Open  ]],
Cell[21856, 624, 1277, 45, 77, "Input"],
Cell[23136, 671, 3730, 81, 803, "Input"],
Cell[26869, 754, 1144, 41, 77, "Input"],
Cell[CellGroupData[{
Cell[28038, 799, 602, 11, 77, "Input"],
Cell[28643, 812, 306, 4, 32, "Output"]
}, Open  ]],
Cell[28964, 819, 1329, 45, 77, "Input"],
Cell[30296, 866, 4398, 91, 935, "Input"],
Cell[34697, 959, 1144, 41, 77, "Input"],
Cell[CellGroupData[{
Cell[35866, 1004, 652, 12, 77, "Input"],
Cell[36521, 1018, 306, 4, 32, "Output"]
}, Open  ]],
Cell[36842, 1025, 1380, 46, 77, "Input"],
Cell[38225, 1073, 4578, 92, 1014, "Input"]
}
]
*)

(* End of internal cache information *)
